from telethon.sync import TelegramClient
import pickle
import os
from colorama import init, Fore

init()

def create_new_vars_file():
    print(f"{Fore.GREEN}Creating new vars.txt file...{Fore.RESET}")
    
    # Get API credentials
    api_id = input("Enter your API ID: ")
    api_hash = input("Enter your API Hash: ")
    phone = input("Enter your phone number (with country code): ")
    
    # Create sessions directory if it doesn't exist
    if not os.path.exists('sessions'):
        os.makedirs('sessions')
    
    # Create Telegram client and authorize
    client = TelegramClient(f'sessions/{phone}', int(api_id), api_hash)
    client.connect()
    
    if not client.is_user_authorized():
        client.send_code_request(phone)
        code = input("Enter the code you received: ")
        client.sign_in(phone, code)
    
    # Save account to vars.txt
    account_data = [phone, api_id, api_hash]
    with open('vars.txt', 'wb') as f:
        pickle.dump(account_data, f)
    
    print(f"{Fore.GREEN}Account added successfully!{Fore.RESET}")
    client.disconnect()

if __name__ == "__main__":
    create_new_vars_file()
